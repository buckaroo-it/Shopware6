(function(){var e={975:function(){},889:function(){},4:function(){},307:function(){let{Application:e}=Shopware,t=Shopware.Classes.ApiService;class a extends t{constructor(e,t,a="buckaroo"){super(e,t,a)}getSupportVersion(){let e=`_action/${this.getApiBasePath()}/version`;return this.httpClient.post(e,{},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}getTaxes(){let e=`_action/${this.getApiBasePath()}/taxes`;return this.httpClient.post(e,{},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}getIn3Icons(){let e=`_action/${this.getApiBasePath()}/in3/logos`;return this.httpClient.post(e,{},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}getApiTest(e,a,n){let r=`_action/${this.getApiBasePath()}/getBuckarooApiTest`;return this.httpClient.post(r,{websiteKeyId:e,secretKeyId:a,saleChannelId:n},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}}e.addServiceProvider("BuckarooPaymentSettingsService",t=>new a(e.getContainer("init").httpClient,t.loginService))},65:function(){let{Application:e}=Shopware,t=Shopware.Classes.ApiService;class a extends t{constructor(e,t,a="buckaroo"){super(e,t,a)}getBuckarooTransaction(e){let a=`_action/${this.getApiBasePath()}/getBuckarooTransaction`;return this.httpClient.post(a,{transaction:e},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}refundPayment(e,a,n,r){let o=`_action/${this.getApiBasePath()}/refund`;return this.httpClient.post(o,{transaction:e,transactionsToRefund:a,orderItems:n,customRefundAmount:r},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}captureOrder(e){let a=`_action/${this.getApiBasePath()}/capture`;return this.httpClient.post(a,{transaction:e},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}createPaylink(e){let a=`_action/${this.getApiBasePath()}/paylink`;return this.httpClient.post(a,{transaction:e},{headers:this.getBasicHeaders()}).then(e=>t.handleResponse(e))}}e.addServiceProvider("BuckarooPaymentService",t=>new a(e.getContainer("init").httpClient,t.loginService))},269:function(){let{Component:e}=Shopware;e.extend("buckaroo-payment-config","sw-extension-config",{})},770:function(e,t,a){var n=a(975);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),a(346).Z("1bc08a40",n,!0,{})},276:function(e,t,a){var n=a(889);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),a(346).Z("0c8d9fb0",n,!0,{})},547:function(e,t,a){var n=a(4);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals),a(346).Z("420a20cd",n,!0,{})},346:function(e,t,a){"use strict";function n(e,t){for(var a=[],n={},r=0;r<t.length;r++){var o=t[r],s=o[0],i={id:e+":"+r,css:o[1],media:o[2],sourceMap:o[3]};n[s]?n[s].parts.push(i):a.push(n[s]={id:s,parts:[i]})}return a}a.d(t,{Z:function(){return g}});var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},s=r&&(document.head||document.getElementsByTagName("head")[0]),i=null,l=0,c=!1,d=function(){},u=null,m="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(e,t,a,r){c=a,u=r||{};var s=n(e,t);return h(s),function(t){for(var a=[],r=0;r<s.length;r++){var i=o[s[r].id];i.refs--,a.push(i)}t?h(s=n(e,t)):s=[];for(var r=0;r<a.length;r++){var i=a[r];if(0===i.refs){for(var l=0;l<i.parts.length;l++)i.parts[l]();delete o[i.id]}}}}function h(e){for(var t=0;t<e.length;t++){var a=e[t],n=o[a.id];if(n){n.refs++;for(var r=0;r<n.parts.length;r++)n.parts[r](a.parts[r]);for(;r<a.parts.length;r++)n.parts.push(f(a.parts[r]));n.parts.length>a.parts.length&&(n.parts.length=a.parts.length)}else{for(var s=[],r=0;r<a.parts.length;r++)s.push(f(a.parts[r]));o[a.id]={id:a.id,refs:1,parts:s}}}}function y(){var e=document.createElement("style");return e.type="text/css",s.appendChild(e),e}function f(e){var t,a,n=document.querySelector("style["+m+'~="'+e.id+'"]');if(n){if(c)return d;n.parentNode.removeChild(n)}if(p){var r=l++;t=k.bind(null,n=i||(i=y()),r,!1),a=k.bind(null,n,r,!0)}else t=v.bind(null,n=y()),a=function(){n.parentNode.removeChild(n)};return t(e),function(n){n?(n.css!==e.css||n.media!==e.media||n.sourceMap!==e.sourceMap)&&t(e=n):a()}}var b=function(){var e=[];return function(t,a){return e[t]=a,e.filter(Boolean).join("\n")}}();function k(e,t,a,n){var r=a?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,r);else{var o=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function v(e,t){var a=t.css,n=t.media,r=t.sourceMap;if(n&&e.setAttribute("media",n),u.ssrId&&e.setAttribute(m,t.id),r&&(a+="\n/*# sourceURL="+r.sources[0]+" */\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={id:n,exports:{}};return e[n](o,o.exports,a),o.exports}a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="bundles/buckaroopayments/",window?.__sw__?.assetPath&&(a.p=window.__sw__.assetPath+"/bundles/buckaroopayments/"),function(){"use strict";let{Component:e,Context:t}=Shopware,n=Shopware.Data.Criteria;e.override("sw-order-detail",{template:'{% block sw_order_detail_content_tabs %}\r\n    <div\r\n     v-if="isPaymentInTestMode && setIsBuckarooPayment"\r\n     style="max-width: 960px; margin: 0 auto 15px; background: rgb(251, 227, 231); border-radius:4px; color: #de294c; display:flex; align-items:center;">\r\n        <div style="background:#de294c;padding: 4px 8px;border-radius: 4px 0 0 4px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24"><defs><path d="m13.7744 1.4124 9.7058 18.6649c.5096.98.1283 2.1875-.8517 2.6971a2 2 0 0 1-.9227.2256H2.2942c-1.1045 0-2-.8954-2-2a2 2 0 0 1 .2256-.9227l9.7058-18.665c.5096-.98 1.7171-1.3613 2.6971-.8517a2 2 0 0 1 .8517.8518zM2.2942 21h19.4116L12 2.335 2.2942 21zM12 17c.5523 0 1 .4477 1 1s-.4477 1-1 1-1-.4477-1-1 .4477-1 1-1zm1-2c0 .5523-.4477 1-1 1s-1-.4477-1-1v-5c0-.5523.4477-1 1-1s1 .4477 1 1v5z" id="icons-default-warning"></path></defs><use xlink:href="#icons-default-warning" fill="#fff" fill-rule="evenodd"></use></svg></div>\r\n        <p style="margin-left:10px;">{{ $tc(\'buckaroo-payment.paymentInTestMode\') }}</p>\r\n    </div>\r\n    {% parent %}\r\n{% endblock %}\r\n\r\n\r\n{% block sw_order_detail_content_tabs_general %}\r\n    {% parent %}\r\n\r\n    <sw-tabs-item v-if="setIsBuckarooPayment" :route="{ name: \'buckaroo.payment.detail\', params: { id: $route.params.id } }" :title="$tc(\'buckaroo-payment.tabs.title\')">\r\n        {{ $tc(\'buckaroo-payment.tabs.title\') }}\r\n    </sw-tabs-item>\r\n    \r\n{% endblock %}\r\n\r\n{% block sw_order_detail_actions %}\r\n    <template v-if="isEditable">\r\n    </template>\r\n    {% parent %}\r\n{% endblock %}',data(){return{isBuckarooPayment:!1,isPaymentInTestMode:!1}},computed:{isEditable(){return!this.isBuckarooPayment||"buckaroo.payment.detail"!==this.$route.name},showTabs(){return!0}},watch:{orderId:{deep:!0,handler(){if(!this.orderId){this.setIsBuckarooPayment(null);return}let e=this.repositoryFactory.create("order"),a=new n(1,1);a.addAssociation("transactions"),e.get(this.orderId,t.api,a).then(e=>{if(this.setPaymentInTestMode(e),e.transactions.length<=0||!e.transactions.last().paymentMethodId){this.setIsBuckarooPayment(null);return}let t=e.transactions.last().paymentMethodId;null!=t&&this.setIsBuckarooPayment(t)})},immediate:!0}},methods:{setPaymentInTestMode(e){e.customFields&&e.customFields.buckaroo_payment_in_test_mode&&(this.isPaymentInTestMode=!0===e.customFields.buckaroo_payment_in_test_mode)},setIsBuckarooPayment(e){e&&this.repositoryFactory.create("payment_method").get(e,t.api).then(e=>{this.isBuckarooPayment=e.formattedHandlerIdentifier.indexOf("buckaroo")>=0})}}});let{Component:r,Context:o}=Shopware;Shopware.Data.Criteria,r.override("sw-order-detail-base",{template:'{% block sw_order_detail_base_line_items_summary %}\r\n\r\n    <sw-card-section divider="top" secondary slim v-if="order.customFields !== null">\r\n        <sw-container columns="1fr 440px"\r\n        class="sw-order-detail__summary" v-if="order.customFields.buckarooFee !== null && order.customFields.buckarooFee > 0">\r\n            <sw-description-list grid="265px 1fr"\r\n            class="sw-order-detail__summary-data">\r\n                <dt>{{ $tc(\'buckaroo-payment.fee\') }}</dt>\r\n                <dd>{{ order.customFields.buckarooFee }}\r\n                    {% if order.currency.isoCode == "PLN" %}\r\n                        PLN\r\n                    {% else %}\r\n                        {{ order.currency.symbol }}\r\n                    {% endif %}\r\n                    </dd>\r\n            </sw-description-list>\r\n        </sw-container>\r\n    </sw-card-section>\r\n\r\n    {% parent %}\r\n    \r\n{% endblock %}'});let{Component:s}=Shopware;s.override("sw-order-user-card",{template:"{% block sw_order_detail_base_secondary_info_payment %}\r\n    <template v-if=\"currentOrder.transactions.length > 0 && (!currentOrder.transactions.last().paymentMethod.translated.customFields || !currentOrder.transactions.last().paymentMethod.translated.customFields.is_buckaroo)\">\r\n        {% parent %}\r\n    </template>\r\n    <template v-if=\"currentOrder.transactions.length > 0 && currentOrder.transactions.last().paymentMethod.translated.customFields && currentOrder.transactions.last().paymentMethod.translated.customFields.is_buckaroo\">\r\n        <dt>{{ $tc('sw-order.detailBase.labelPaymentMethod') }}</dt>\r\n        <dd>\r\n            <template v-if=\"config['BuckarooPayments.config.' + currentOrder.transactions.last().paymentMethod.translated.customFields.buckaroo_key + 'Label']\">\r\n                {{ config['BuckarooPayments.config.' + currentOrder.transactions.last().paymentMethod.translated.customFields.buckaroo_key + 'Label'] }}\r\n            </template>\r\n        </dd>\r\n    </template>\r\n{% endblock %}\r\n\r\n",inject:["systemConfigApiService"],data(){return{config:{}}},created(){this.systemConfigApiService.getValues("BuckarooPayments.config",null).then(e=>{this.config=e}).finally(()=>{})}});let{Component:i}=Shopware;i.override("sw-system-config",{template:'{% block sw_system_config_content_card %}\r\n    <template v-if="domain !== \'BuckarooPayments.config\'">\r\n        {% parent() %}\r\n    </template>\r\n    <template v-else>\r\n        <buckaroo-main-config\r\n                :modelValue="actualConfigData[currentSalesChannelId]"\r\n                @update:modelValue="actualConfigData[currentSalesChannelId] = $event"\r\n                :configSettings="config"\r\n                :isNotDefaultSalesChannel="isNotDefaultSalesChannel"\r\n                :currentSalesChannelId="currentSalesChannelId"\r\n                :elementMethods="{getElementBind, getFieldError, getInheritWrapperBind, getInheritedValue, hasMapInheritanceSupport, getInlineSnippet, kebabCase}"\r\n                v-if="!isLoading"\r\n        ></buckaroo-main-config>\r\n    </template>\r\n{% endblock %}\r\n',methods:{saveAll(){return(console.log("saveAll called, domain:",this.domain),"BuckarooPayments.config"!==this.domain)?this.$super("saveAll"):this.saveBuckaroo()},saveBuckaroo(){return console.log("saveBuckaroo called"),this.isLoading=!0,this.systemConfigApiService.batchSave(this.getSelectedValues()).finally(()=>{this.isLoading=!1})},getCurrentConfigCard(){let e=this.$route.params?.paymentCode||"general";return this.config.filter(t=>t.name===e)?.pop()},getSelectedValues(){let e=this.actualConfigData[this.currentSalesChannelId];console.log("currentConfigValues at sw-system-config:",e);let t=this.getCurrentConfigCard();if(console.log("currentPaymentCard:",t),t?.elements){let a={};return t?.elements.forEach(t=>{console.log("Element name:",t.name),console.log("Current value for element:",e[t.name]),t?.name&&(a[t.name]=e[t.name])}),console.log("Actual config values:",a),{[this.currentSalesChannelId]:a}}return this.actualConfigData}}}),a(547);let{Component:l,Mixin:c,Filter:d,Context:u}=Shopware,m=Shopware.Data.Criteria;l.register("buckaroo-payment-detail",{template:'{% block buckaroo_payment_detail %}\r\n    <div class="buckaroo-payment-detail">\r\n        \r\n        <sw-card positionIdentifier="bk-paylink" :title="$tc(\'buckaroo-payment.paymentDetail.paylinkTitle\')" v-if="isPaylinkVisible">\r\n\r\n            {{ $tc(\'buckaroo-payment.paymentDetail.paylinkDescription\') }}\r\n            \r\n            <span v-if="paylink"> <br>\r\n            {{ $tc(\'buckaroo-payment.paymentDetail.yourLink\') }}: <a :href="paylink">{{ paylink }}</a>\r\n            </span>\r\n\r\n            <sw-container columns="1fr 440px" class="sw-order-detail__summary">\r\n                <sw-description-list grid="265px 1fr" class="sw-order-detail__summary-data"><dt></dt> <dd>\r\n            \r\n                        <sw-button @click="createPaylink(orderId)" :disabled="!isPaylinkAvailable">\r\n                            {{ $tc(\'buckaroo-payment.paymentDetail.paylinkButton\') }}\r\n                        </sw-button></dd>\r\n                </sw-description-list>\r\n            </sw-container>\r\n\r\n        </sw-card>\r\n\r\n         <sw-card positionIdentifier="bk-refund" :title="$tc(\'buckaroo-payment.paymentDetail.refundTitle\')">\r\n            \r\n            {{ $tc(\'buckaroo-payment.orderItems.title\') }}\r\n            <sw-data-grid :dataSource="orderItems"\r\n                :columns="orderItemsColumns"\r\n                :showActions="false"\r\n                :showSelection="false">\r\n\r\n                    <template #column-name="{ item }">\r\n                        <sw-product-variant-info :showTooltip="false" :variations="item.variations">\r\n                            {{ item.name }}\r\n                        </sw-product-variant-info>\r\n                    </template>\r\n                    <template #column-quantity="{ item }">\r\n                        <input class="bk-reund-qty" type="number" min="0" :max="item.quantityMax" v-model="item.quantity" @input="recalculateOrderItems" onkeydown="return event.keyCode !== 69">\r\n                    </template>\r\n\r\n            </sw-data-grid>\r\n\r\n            <sw-container columns="1fr 440px" class="sw-order-detail__summary">\r\n                <sw-description-list grid="265px 1fr" class="sw-order-detail__summary-data">\r\n                        <dt>{{ $tc(\'buckaroo-payment.paymentDetail.amountTotalTitle\') }}: </dt>\r\n                        <dd>{{ buckaroo_refund_amount }}  {{ currency }}</dd>\r\n                </sw-description-list>\r\n            </sw-container>\r\n                 \r\n            <sw-card-section divider="top" secondary slim>\r\n                <sw-container columns="1fr 440px"\r\n                              class="sw-order-detail__summary">\r\n                </sw-container>\r\n\r\n                <sw-data-grid :dataSource="transactionsToRefund"\r\n                    :columns="transactionsToRefundColumns"\r\n                    :showHeader="false"\r\n                    :showActions="false"\r\n                    :showSelection="false">\r\n\r\n                        <template #column-transaction_method="{ item }">\r\n                                <span v-if="item.transaction_method == \'KbcPaymentButton\'">\r\n                                    Kbc\r\n                                </span>\r\n                                <span v-else>\r\n                                    {{ item.transaction_method }}\r\n                                </span>\r\n                        </template>\r\n\r\n                        <template #column-amount="{ item }">\r\n                            <input type="number" min="0" :max="item.amountMax" v-model="item.amount"  @input="recalculateRefundItems" onkeydown="return event.keyCode !== 69">\r\n                        </template>\r\n\r\n                </sw-data-grid>\r\n\r\n                <sw-container v-if="!isAuthorized" columns="1fr 440px" class="sw-order-detail__summary">\r\n                    <sw-description-list grid="265px 1fr" class="sw-order-detail__summary-data">\r\n                            <dt>{{ $tc(\'buckaroo-payment.paymentDetail.amountCustomRefundTitle\') }}: </dt>\r\n                            <dd>\r\n                                <input id="buckaroo_custom_refund_enabled" type="checkbox"\r\n                                       @click="toggleCustomRefund()">\r\n                                <input id="buckaroo_custom_refund_amount" type="number"\r\n                                       v-model="buckaroo_refund_total_amount" disabled style="width:70px;"> {{ currency }}\r\n                            </dd>\r\n                    </sw-description-list>\r\n                    <sw-description-list grid="265px 1fr" class="sw-order-detail__summary-data">\r\n                            <dt>{{ $tc(\'buckaroo-payment.paymentDetail.amountRefundTotalTitle\') }}: </dt>\r\n                            <dd>{{ buckaroo_refund_total_amount }} {{ currency }}</dd>\r\n                    </sw-description-list>\r\n                </sw-container>\r\n                 \r\n            </sw-card-section>\r\n\r\n            <sw-container columns="1fr 440px" class="sw-order-detail__summary">\r\n                <sw-description-list grid="265px 1fr" class="sw-order-detail__summary-data"><dt></dt><dd>\r\n                    <sw-button @click="refundOrder(orderId, buckaroo_refund_amount)" :disabled="!isRefundPossible || isAuthorized">\r\n                    {{ $tc(\'buckaroo-payment.paymentDetail.buttonTitle\') }}\r\n                    </sw-button></dd>\r\n                </sw-description-list>\r\n            </sw-container>\r\n\r\n         </sw-card>\r\n\r\n        <sw-card positionIdentifier="bk-pay-desc" :title="$tc(\'buckaroo-payment.paymentDetail.payTitle\')">\r\n\r\n            {{ $tc(\'buckaroo-payment.paymentDetail.payDescription\') }}\r\n\r\n            <sw-container columns="1fr 440px" class="sw-order-detail__summary">\r\n                <sw-description-list grid="265px 1fr" class="sw-order-detail__summary-data"><dt></dt><dd>\r\n                        <sw-button @click="captureOrder(orderId)" :disabled="!isCapturePossible">\r\n                            {{ $tc(\'buckaroo-payment.paymentDetail.payButton\') }}\r\n                        </sw-button></dd>\r\n                </sw-description-list>\r\n            </sw-container>\r\n\r\n        </sw-card>\r\n\r\n         <sw-card positionIdentifier="bk-pay-transaction" :title="$tc(\'buckaroo-payment.paymentDetail.transactionsTitle\')">\r\n            <sw-data-grid :dataSource="relatedResources"\r\n                :columns="relatedResourceColumns"\r\n                :showActions="false"\r\n                :showSelection="false">\r\n\r\n                    <template #column-transaction_method="{ item }">\r\n                            <span v-if="item.transaction_method == \'KbcPaymentButton\'">\r\n                                Kbc\r\n                            </span>\r\n                            <span v-else>\r\n                                {{ item.transaction_method }}\r\n                            </span>\r\n                    </template>\r\n\r\n            </sw-data-grid>\r\n         </sw-card>\r\n\r\n\r\n        <sw-loader v-if="isLoading">\r\n        </sw-loader>\r\n    </div>\r\n{% endblock %}',inject:["repositoryFactory","BuckarooPaymentService","systemConfigApiService"],mixins:[c.getByName("notification")],data(){return{config:{},buckaroo_refund_amount:"0",buckaroo_refund_total_amount:"0",currency:"EUR",isRefundPossible:!0,isCapturePossible:!1,isPaylinkAvailable:!1,isPaylinkVisible:!1,paylinkMessage:"",paylink:"",isLoading:!1,order:!1,buckarooTransactions:null,orderItems:[],transactionsToRefund:[],relatedResources:[],isAuthorized:!1}},computed:{orderItemsColumns(){return[{property:"name",label:this.$tc("buckaroo-payment.orderItems.types.name"),allowResize:!1,primary:!0,inlineEdit:!0,multiLine:!0},{property:"quantity",label:this.$tc("buckaroo-payment.orderItems.types.quantity"),rawData:!0,align:"right"},{property:"totalAmount",label:this.$tc("buckaroo-payment.orderItems.types.totalAmount"),rawData:!0,align:"right"}]},transactionsToRefundColumns(){return[{property:"transaction_method",rawData:!0},{property:"amount",rawData:!0}]},relatedResourceColumns(){return[{property:"created_at",label:this.$tc("buckaroo-payment.transactionHistory.types.created_at"),rawData:!0},{property:"total",label:this.$tc("buckaroo-payment.transactionHistory.types.total"),rawData:!0},{property:"shipping_costs",label:this.$tc("buckaroo-payment.transactionHistory.types.shipping_costs"),rawData:!0},{property:"total_excluding_vat",label:this.$tc("buckaroo-payment.transactionHistory.types.total_excluding_vat"),rawData:!0},{property:"vat",label:this.$tc("buckaroo-payment.transactionHistory.types.vat"),rawData:!0},{property:"transaction_key",label:this.$tc("buckaroo-payment.transactionHistory.types.transaction_key"),rawData:!0},{property:"transaction_method",label:this.$tc("buckaroo-payment.transactionHistory.types.transaction_method"),rawData:!0},{property:"statuscode",label:this.$tc("buckaroo-payment.transactionHistory.types.statuscode"),rawData:!0}]}},created(){this.createdComponent()},methods:{recalculateOrderItems(){for(let e in this.buckaroo_refund_amount=0,this.orderItems)this.orderItems[e].totalAmount=parseFloat(parseFloat(this.orderItems[e].unitPrice)*parseFloat(this.orderItems[e].quantity||0)).toFixed(2),this.buckaroo_refund_amount=parseFloat(parseFloat(this.buckaroo_refund_amount)+parseFloat(this.orderItems[e].totalAmount)).toFixed(2)},recalculateRefundItems(){for(let e in this.buckaroo_refund_total_amount=0,this.transactionsToRefund)this.transactionsToRefund[e].amount&&(this.buckaroo_refund_total_amount=parseFloat(parseFloat(this.buckaroo_refund_total_amount)+parseFloat(this.transactionsToRefund[e].amount)).toFixed(2))},getCustomRefundEnabledEl(){return document.getElementById("buckaroo_custom_refund_enabled")},getCustomRefundAmountEl(){return document.getElementById("buckaroo_custom_refund_amount")},toggleCustomRefund(){this.getCustomRefundEnabledEl()&&this.getCustomRefundAmountEl()&&(this.getCustomRefundAmountEl().disabled=!this.getCustomRefundEnabledEl().checked)},getCustomRefundAmount(){return this.getCustomRefundEnabledEl()&&this.getCustomRefundAmountEl()&&this.getCustomRefundEnabledEl().checked?this.getCustomRefundAmountEl().value:0},createdComponent(){let e=this,t=this.$route.params.id;this.systemConfigApiService.getValues("BuckarooPayments.config",null).then(e=>{this.config=e});let a=this.repositoryFactory.create("order"),n=new m(1,1);this.orderId=t,n.addAssociation("transactions.paymentMethod").addAssociation("transactions"),n.getAssociation("transactions").addSorting(m.sort("createdAt")),a.get(t,u.api,n).then(t=>{e.checkedIsAuthorized(t),e.isCapturePossible=t.transactions&&t.transactions.last().paymentMethod&&t.transactions.last().paymentMethod.customFields&&t.transactions.last().paymentMethod.customFields.buckaroo_key&&["klarnakp","billink"].includes(t.transactions.last().paymentMethod.customFields.buckaroo_key.toLowerCase())||e.isAfterpayCapturePossible(t),e.isPaylinkVisible=e.isPaylinkAvailable=this.getConfigValue("paylinkEnabled")&&t.stateMachineState&&t.stateMachineState.technicalName&&"open"==t.stateMachineState.technicalName&&t.transactions&&"open"==t.transactions.last().stateMachineState.technicalName}),this.BuckarooPaymentService.getBuckarooTransaction(t).then(t=>{e.orderItems=[],e.transactionsToRefund=[],e.relatedResources=[],this.$emit("loading-change",!1),t.orderItems.forEach(t=>{e.orderItems.push({id:t.id,name:t.name,quantity:t.quantity,quantityMax:t.quantity,unitPrice:t.unitPrice.value,totalAmount:t.totalAmount.value,variations:t.variations||[]})}),e.recalculateOrderItems(),t.transactionsToRefund.forEach(t=>{e.transactionsToRefund.push({id:t.id,transactions:t.transactions,amount:t.total,amountMax:t.total,currency:t.currency,transaction_method:t.transaction_method,logo:t.transaction_method?t.logo:null}),e.currency=t.currency}),e.recalculateRefundItems(),t.transactions.forEach(t=>{e.relatedResources.push({id:t.id,transaction_key:t.transaction,total:t.total,total_excluding_vat:t.total_excluding_vat,shipping_costs:t.shipping_costs,vat:t.vat,transaction_method:t.transaction_method,logo:t.transaction_method?t.logo:null,created_at:t.created_at,statuscode:t.statuscode})})}).catch(e=>{console.log("errorResponse",e)})},isAfterpayCapturePossible(e){return!0===e.customFields.buckaroo_is_authorize},checkedIsAuthorized(e){this.isAuthorized=e?.transactions?.last()?.stateMachineState?.technicalName==="authorized"},refundOrder(e,t){let a=this;a.isRefundPossible=!1,this.BuckarooPaymentService.refundPayment(e,this.transactionsToRefund,this.orderItems,this.getCustomRefundAmount()).then(e=>{for(let t in e)e[t].status?this.createNotificationSuccess({title:a.$tc("buckaroo-payment.settingsForm.titleSuccess"),message:a.$tc(e[t].message)+e[t].amount}):this.createNotificationError({title:a.$tc("buckaroo-payment.settingsForm.titleError"),message:a.$tc(e[t].message)});a.isRefundPossible=!0,this.createdComponent()}).catch(e=>{this.createNotificationError({title:this.$tc("buckaroo-payment.settingsForm.titleError"),message:e.response.data.message}),a.isRefundPossible=!0})},createPaylink(e){let t=this;t.isPaylinkAvailable=!1,this.BuckarooPaymentService.createPaylink(e,this.transactionsToRefund,this.orderItems).then(e=>{e.status?(t.paylinkMessage=t.$tc(e.message)+e.paylinkhref,t.paylink=e.paylink,this.createNotificationSuccess({title:t.$tc("buckaroo-payment.settingsForm.titleSuccess"),message:t.paylinkMessage})):this.createNotificationError({title:t.$tc("buckaroo-payment.settingsForm.titleError"),message:t.$tc(e.message)}),t.isPaylinkAvailable=!0}).catch(e=>{this.createNotificationError({title:this.$tc("buckaroo-payment.settingsForm.titleError"),message:e.response.data.message}),t.isPaylinkAvailable=!0})},getConfigValue(e){return this.config[`BuckarooPayments.config.${e}`]},captureOrder(e){let t=this;t.isCapturePossible=!1,this.BuckarooPaymentService.captureOrder(e,this.transactionsToRefund,this.orderItems).then(e=>{e.status?this.createNotificationSuccess({title:t.$tc("buckaroo-payment.settingsForm.titleSuccess"),message:e.message}):this.createNotificationError({title:t.$tc("buckaroo-payment.settingsForm.titleError"),message:e.message}),t.isCapturePossible=!0,this.createdComponent()}).catch(e=>{this.createNotificationError({title:this.$tc("buckaroo-payment.settingsForm.titleError"),message:t.$tc(e.response.data.message)}),t.isCapturePossible=!0})}}}),a(269);var p=JSON.parse('{"buckaroo-payment":{"fee":"Buckaroo Betaaltoeslag","order":{"refundDescription":"Refund voor bestelling #orderNumber"},"general":{"title":"Buckaroo","description":"Buckaroo Payment"},"settingsForm":{"save":"Opslaan","titleSuccess":"Succes","titleError":"Foutmelding"},"supportModal":{"menuButton":"Version & Support","title":"Versie & Support","support":{"description":"Zorg ervoor dat u uw website key bij de hand heeft voordat u contact opneemt met Buckaroo technical support","label1":"Buckaroo Plaza:","label2":"Telefoonnummer:","label3":"E-mail:","label4":"Website:","your_version":"Uw PHP versie:","version":"Versie compatibiliteit","information":"Informatie"}},"tabs":{"title":"Buckaroo Payment","overview":"Overzicht"},"paymentDetail":{"yourLink":"Uw Paylink","paylinkButton":"Cre\xeber Paylink","paylinkDescription":"Cre\xeber Paylink voor order","paylinkTitle":"Paylink","refundTitle":"Terugbetaling","transactionsTitle":"Transacties","amountTitle":"Hoeveelheid","amountTotalTitle":"Algemeen totaal (grand total)","amountRefundTotalTitle":"Terugbetaling Algemeen totaal (grand total)","amountCustomRefundTitle":"Aangepast bedrag terugbetalen","buttonTitle":"Terugbetaling","successTitle":"Success","successMessage":"Buckaroo terugbetaling succesvol","errorTitle":"Foutmelding","payTitle":"Betaling vastleggen (Capture)","payDescription":"Factuur voor bestelling vastleggen (Capture) en aanmaken","payButton":"Betaling vastleggen (Capture)"},"orderItems":{"title":"Artikelen om terug te betalen","types":{"id":"id","name":"Titel","quantity":"Aantal om terug te betalen","totalAmount":"Subtotaal"}},"transactionsToRefund":{"title":"Terugbetaling Totaal"},"transactionHistory":{"types":{"id":"id","created_at":"Datum/tijd","total":"Totaal","shipping_costs":"Verzendkosten","total_excluding_vat":"Totaal exclusief BTW","total_including_vat":"Totaal inclusief BTW","vat":"BTW","transaction_key":"Transactie key","transaction_method":"Betaalmethode","statuscode":"Status"}},"messageNotValid":"Dit veld is niet geldig.","messageNotBlank":"Dit veld mag niet leeg zijn.","button":{"labelTestApi":"Test gegevens"},"afterpay":{"setup":"Belastingkoppeling instellen voor Riverty | AfterPay old ","hightTaxes":"Hoge BTW-heffingen","middleTaxes":"Middelmatige BTW-belastingen","lowTaxes":"Lage BTW-heffingen","zeroTaxes":"Nul VAT","noTaxes":"Geen BTW"},"paymentInTestMode":"De betaling voor deze bestelling is in testmodus uitgevoerd","refund":{"not_supported":"Terugbetaling wordt niet ondersteund","already_refunded":"Deze bestelling is al terugbetaald","refunded_amount":"Buckaroo terugbetaling succesvol"},"test_api":{"connection_ready":"Verbinding gereed","connection_failed":"Verbinding mislukt"},"paylink":{"invalid_amount":"Het bedrag is niet geldig","pay_link":"Uw Paylink:"},"missing_order_id":"Ontbrekende bestelling orderId","missing_transaction":"Order transactie niet gevonden","general_request_error":"Helaas is er een fout opgetreden tijdens het verwerken van uw aanvraag. Probeer het opnieuw.","in3LogoLabel":"Betaalmethode Logo:","configure-payment":"Configure payment","configure-link":"Configure","payment-methods":"Payment methods"}}'),g=JSON.parse('{"buckaroo-payment":{"fee":"Buckaroo Geb\xfchr","order":{"refundDescription":"R\xfcckerstattung f\xfcr Bestellung #orderNumber"},"general":{"title":"Buckaroo","description":"Buckaroo Zahlung"},"settingsForm":{"save":"Speichern","titleSuccess":"Erfolg","titleError":"Fehler"},"supportModal":{"menuButton":"Version & Unterst\xfctzung","title":"Version & Unterst\xfctzung","support":{"description":"Bevor Sie den technischen Support von Buckaroo kontaktieren, bitte holen Sie Ihren (H\xe4ndler-)Schl\xfcssel und Geheimschl\xfcssel ab.","label1":"Buckaroo Plaza:","label2":"Telefon:","label3":"E-Mail:","label4":"Webseite:","your_version":"Ihre PHP-Version:","version":"Versionskompatibilit\xe4t","information":"Informationen"}},"tabs":{"title":"Buckaroo Payment","overview":"\xdcbersicht"},"paymentDetail":{"yourLink":"Ihr Paylink","paylinkButton":"Paylink erstellen","paylinkDescription":"Paylink erstellen f\xfcr Bestellung","paylinkTitle":"Paylink","refundTitle":"R\xfcckerstattung","transactionsTitle":"Transaktionen","amountTitle":"Betrag","amountTotalTitle":"Gesamtsumme","amountRefundTotalTitle":"Gesamtsumme der R\xfcckerstattung","amountCustomRefundTitle":"R\xfcckerstattung individueller Betrag","buttonTitle":"R\xfcckerstattung","successTitle":"Erfolg","successMessage":"Buckaroo-Erfolg, zur\xfcckerstattet","errorTitle":"Fehler","payTitle":"Zahlung erfassen (Capture)","payDescription":"Erfassen (Capture) und Rechnung f\xfcr Bestellung erstellen","payButton":"Zahlung erfassen (Capture)"},"orderItems":{"title":"Artikel zur R\xfcckerstattung","types":{"id":"id","name":"Titel","quantity":"Menge zur R\xfcckerstattung","totalAmount":"Teilsumme"}},"transactionsToRefund":{"title":"R\xfcckerstattungssummen"},"transactionHistory":{"types":{"id":"id","created_at":"Datum/Uhrzeit","total":"Gesamt","shipping_costs":"Versandkosten","total_excluding_vat":"Gesamt ohne MwSt. (VAT)","total_including_vat":"Gesamt inklusive MwSt. (VAT)","vat":"MwSt. (VAT)","transaction_key":"Transaktionsschl\xfcssel","transaction_method":"Zahlungsmethode","statuscode":"Status"}},"messageNotValid":"Dieses Feld ist nicht g\xfcltig.","messageNotBlank":"Dieses Feld darf nicht leer sein.","button":{"labelTestApi":"Verbindung testen"},"afterpay":{"setup":"Steuerzuordnung f\xfcr Riverty | AfterPay old einrichten ","hightTaxes":"Hohe MwSt. (VAT)","middleTaxes":"Mittlere MwSt. (VAT)","lowTaxes":"Niedrige MwSt. (VAT)","zeroTaxes":"Keine MwSt. (VAT)","noTaxes":"Keine Mehrwertsteuer"},"paymentInTestMode":"Die Zahlung f\xfcr diese Bestellung wurde im Testmodus durchgef\xfchrt","refund":{"not_supported":"R\xfcckerstattung wird nicht unterst\xfctzt","already_refunded":"Diese Bestellung wurde bereits zur\xfcckerstattet","refunded_amount":"Erfolgreich von Buckaroo erstattet"},"test_api":{"connection_ready":"Verbindung bereit","connection_failed":"Verbindung fehlgeschlagen"},"paylink":{"invalid_amount":"Betrag ist nicht g\xfcltig","pay_link":"Ihr Zahlungslink (Paylink):"},"missing_order_id":"Fehlende Bestell-ID","missing_transaction":"Transaktion der Bestellung nicht gefunden","general_request_error":"Leider ist ein Fehler bei der Bearbeitung Ihrer Anfrage aufgetreten. Bitte versuchen Sie es erneut.","in3LogoLabel":"Zahlungslogo:","configure-payment":"Configure payment","configure-link":"Configure","payment-methods":"Payment methods"}}'),h=JSON.parse('{"buckaroo-payment":{"fee":"Buckaroo Fee","order":{"refundDescription":"Refund for order #orderNumber"},"general":{"title":"Buckaroo","description":"Buckaroo Payment"},"settingsForm":{"save":"Save","titleSuccess":"Success","titleError":"Error"},"supportModal":{"menuButton":"Version & Support","title":"Version & Support","support":{"description":"Before contacting Buckaroo technical support, please retrieve your (Merchant) key, Secret key, certificate and certificate thumbprint.","label1":"Buckaroo Payment Plaza:","label2":"Phone:","label3":"E-mail:","label4":"Website:","your_version":"Your PHP version:","version":"Version compatibility","information":"Information"}},"tabs":{"title":"Buckaroo Payment","overview":"Overview"},"paymentDetail":{"yourLink":"Your Paylink","paylinkButton":"Create paylink","paylinkDescription":"Create paylink for order","paylinkTitle":"Paylink","refundTitle":"Refund","transactionsTitle":"Transactions","amountTitle":"Amount","amountTotalTitle":"Grand total","amountRefundTotalTitle":"Refund Grand total","amountCustomRefundTitle":"Refund custom amount","buttonTitle":"Refund","successTitle":"Success","successMessage":"Buckaroo success refunded ","errorTitle":"Error","payTitle":"Capture payment","payDescription":"Capture and create invoice for order","payButton":"Capture payment"},"orderItems":{"title":"Items to Refund","types":{"id":"id","name":"Title","quantity":"Qty to Refund","totalAmount":"Subtotal"}},"transactionsToRefund":{"title":"Refund Totals"},"transactionHistory":{"types":{"id":"id","created_at":"Date/time","total":"Total","shipping_costs":"Shipping costs","total_excluding_vat":"Total excluding VAT","total_including_vat":"Total including VAT","vat":"VAT","transaction_key":"Transaction key","transaction_method":"Payment method","statuscode":"Status"}},"messageNotValid":"This field not valid.","messageNotBlank":"This field must not be empty.","button":{"labelTestApi":"Test connection"},"afterpay":{"setup":"Setup tax association for Riverty | AfterPay old ","hightTaxes":"High VAT taxes","middleTaxes":"Middle VAT taxes","lowTaxes":"Low VAT taxes","zeroTaxes":"Zero VAT","noTaxes":"No VAT tax"},"paymentInTestMode":"The payment for this order was made in test mode","refund":{"not_supported":"Refund is not supported","already_refunded":"This order is already refunded","refunded_amount":"Buckaroo success refunded"},"test_api":{"connection_ready":"Connection ready","connection_failed":"Connection failed"},"paylink":{"invalid_amount":"Amount is not valid","pay_link":"Your Paylink:"},"missing_order_id":"Missing order orderId","missing_transaction":"Order transaction not found","general_request_error":"Unfortunately an error occurred while processing your request. Please try again.","in3LogoLabel":"Payment Logo:","configure-payment":"Configure payment","configure-link":"Configure","payment-methods":"Payment methods"}}');let{Module:y}=Shopware;y.register("buckaroo-payment",{type:"plugin",name:"BuckarooPayment",title:"buckaroo-payment.general.title",description:"buckaroo-payment.general.description",version:"1.0.0",targetVersion:"1.0.0",color:"#000000",icon:"default-action-settings",snippets:{"nl-NL":p,"de-DE":g,"en-GB":h},routeMiddleware(e,t){"sw.order.detail"===t.name&&t.children.push({component:"buckaroo-payment-detail",name:"buckaroo.payment.detail",isChildren:!0,path:"/sw/order/buckaroo/detail/:id"}),e(t)},routes:{config:{component:"buckaroo-payment-config",path:":namespace/payment/:paymentCode",name:"buckaroo.config.payment",meta:{parentPath:"sw.extension.config"},props:{default(e){return{namespace:e.params.namespace}}}}}}),a(65),a(307);let{Component:f}=Shopware;f.register("buckaroo-afterpay-old-tax",{template:'<div>\r\n    <a style="margin-bottom:10px;" @click="showTaxes = !showTaxes">{{$tc(\'buckaroo-payment.afterpay.setup\')}}</a>\r\n    <div v-if="showTaxes" style="padding: 10px;background: rgb(246 246 246); margin-bottom:10px;">\r\n        <div class="tax" v-for="tax in taxes">\r\n            <sw-select-field\r\n            :label="tax.name"\r\n            label-property="name"\r\n            value-property="id"\r\n            :options="afterpayTaxes"\r\n            @change="setTaxAssociation(tax.id, $event)"\r\n            :value="getSelectValue(tax.id)"\r\n            ></sw-select-field>\r\n        </div>\r\n    </div>\r\n</div>',inject:["BuckarooPaymentSettingsService"],data(){return{taxes:[],showTaxes:!1,afterpayTaxes:[{name:this.$tc("buckaroo-payment.afterpay.hightTaxes"),id:1},{name:this.$tc("buckaroo-payment.afterpay.middleTaxes"),id:5},{name:this.$tc("buckaroo-payment.afterpay.lowTaxes"),id:2},{name:this.$tc("buckaroo-payment.afterpay.zeroTaxes"),id:3},{name:this.$tc("buckaroo-payment.afterpay.noTaxes"),id:4}],taxAssociation:{}}},model:{prop:"value",event:"change"},computed:{},props:{name:{type:String,required:!0,default:""},value:{type:Object,required:!1,default(){return{}}}},created(){this.BuckarooPaymentSettingsService.getTaxes().then(e=>{this.taxes=e.taxes.map(e=>({id:e.id,name:e.name}))})},methods:{setTaxAssociation(e,t){this.taxAssociation[e]=t,this.$emit("change",{...this.value,...this.taxAssociation})},getSelectValue(e){if(this.value[e])return this.value[e]}}});let{Component:b}=Shopware;b.register("buckaroo-main-config",{template:'<div>\r\n    <buckaroo-config-card\r\n            :card="mainCard"\r\n            :methods="elementMethods"\r\n            :isNotDefaultSalesChannel="isNotDefaultSalesChannel"\r\n            :currentSalesChannelId="currentSalesChannelId"\r\n            :modelValue="localConfigData"\r\n            @update:modelValue="localConfigData = $event"\r\n    ></buckaroo-config-card>\r\n    <buckaroo-payment-list\r\n            v-if="selectedCard === \'general\'"\r\n            :configSettings="configSettings"\r\n            :currentSalesChannelId="currentSalesChannelId"\r\n            :modelValue="localConfigData"\r\n            @update:modelValue="localConfigData = $event">\r\n    </buckaroo-payment-list>\r\n</div>\r\n',props:{configSettings:{type:Array,required:!0},modelValue:{type:Object,required:!0},elementMethods:{type:Object,required:!0},isNotDefaultSalesChannel:{type:Boolean,required:!0},currentSalesChannelId:{type:String,required:!0}},data(){return{selectedCard:this.$route.params?.paymentCode||"general",localConfigData:{...this.modelValue}}},watch:{$route(e){e.params?.paymentCode&&(this.selectedCard=e.params.paymentCode)},modelValue:{handler(e){this.localConfigData={...e},console.log("modelValue changed:",e)},deep:!0},localConfigData:{handler(e){this.$emit("update:modelValue",e),console.log("localConfigData changed:",e)},deep:!0}},computed:{mainCard(){return this.configSettings.filter(e=>e.name===this.selectedCard)?.pop()}},created(){console.log("Initial localConfigData:",this.localConfigData)}});let{Component:k}=Shopware;k.register("buckaroo-config-card",{template:'<sw-card position-identifier="buckaroo-config-card">\r\n    <template #title>\r\n        {{ getInlineSnippet(card.title) }}\r\n    </template>\r\n    <template v-for="element in card.elements" :key="element.name">\r\n        <template v-if="canShow(element)">\r\n            <slot\r\n                    name="card-element"\r\n                    v-bind="{ element: getElementBind(element), config: localConfigData, card }"\r\n            >\r\n                <sw-inherit-wrapper\r\n                        :modelValue="localConfigData[element.name]"\r\n                        @update:modelValue="localConfigData[element.name] = $event"\r\n                        v-bind="getInheritWrapperBind(element)"\r\n                        :has-parent="isNotDefaultSalesChannel"\r\n                        :inherited-value="getInheritedValue(element)"\r\n                        :class="\'sw-system-config--field-\' + kebabCase(getElementBind(element).name)"\r\n                >\r\n                    <template #content="props">\r\n                        <sw-form-field-renderer\r\n                                v-bind="getElementBind(element, props)"\r\n                                :key="props.isInheritField + props.isInherited"\r\n                                :disabled="props.isInherited"\r\n                                :value="props.currentValue"\r\n                                :error="getFieldError(element.name)"\r\n                                @input="props.updateCurrentValue"\r\n                                @change="props.updateCurrentValue"\r\n                        >\r\n                            <template #label>\r\n                                {{ element.config.label[$root.$i18n.locale] }}\r\n                            </template>\r\n                            <template #description>\r\n                                {{ element.config.description }}\r\n                            </template>\r\n                            <template #helpText>\r\n                                {{ element.config.helpText[$root.$i18n.locale] }}\r\n                            </template>\r\n                        </sw-form-field-renderer>\r\n                    </template>\r\n                </sw-inherit-wrapper>\r\n            </slot>\r\n            <buckaroo-test-credentials\r\n                    v-if="canShowCredentialTester(element)"\r\n                    :config="localConfigData"\r\n                    :currentSalesChannelId="currentSalesChannelId"\r\n            />\r\n        </template>\r\n    </template>\r\n</sw-card>\r\n',inject:["systemConfigApiService"],props:{card:{type:Object,required:!0},methods:{type:Object,required:!0},isNotDefaultSalesChannel:{type:Boolean,required:!0},modelValue:{type:Object,required:!0},currentSalesChannelId:{type:String,required:!0}},data(){let e={...this.modelValue};return this.card.elements.forEach(t=>{e[t.name]||(e[t.name]=null)}),{localConfigData:e,isLoading:!1}},watch:{modelValue:{handler(e){let t={...e};this.card.elements.forEach(e=>{t[e.name]||(t[e.name]=null)}),this.localConfigData=t,console.log("modelValue changed:",e)},deep:!0},localConfigData:{handler(e){this.$emit("update:modelValue",e),console.log("localConfigData changed:",e)},deep:!0}},methods:{getElementBind(e,t){return console.log("Element:",e),console.log("Props:",t),this.methods.getElementBind(e,t)},getInheritWrapperBind(e){return this.methods.getInheritWrapperBind(e)},getFieldError(e){return this.methods.getFieldError(e)},kebabCase(e){return this.methods.kebabCase(e)},getInlineSnippet(e){return this.methods.getInlineSnippet(e)},getInheritedValue(e){return this.methods.getInheritedValue(e)},canShow(e){let t=e.name.replace("BuckarooPayments.config.","");return -1!==["orderStatus","paymentSuccesStatus","sendInvoiceEmail"].indexOf(t)?this.getValueForName("advancedConfiguration"):"idealprocessingRenderMode"===t?this.getValueForName("idealprocessingShowissuers"):"idealRenderMode"===t?this.getValueForName("idealShowissuers"):"afterpayPaymentstatus"===t?this.getValueForName("afterpayCaptureonshippent"):"afterpayOldtax"!==t||this.getValueForName("afterpayEnabledold")},getValueForName(e){return this.localConfigData[`BuckarooPayments.config.${e}`]},canShowCredentialTester(e){return this.getValueForName("advancedConfiguration")?"BuckarooPayments.config.orderStatus"===e.name:"BuckarooPayments.config.advancedConfiguration"===e.name}},created(){console.log("Initial localConfigData:",this.localConfigData)}}),a(770);let{Component:v,Filter:_}=Shopware;v.register("buckaroo-payment-list",{template:'<sw-card\r\n        position-identifier="bk-config-payment-list"\r\n        :title="$tc(\'buckaroo-payment.payment-methods\')"\r\n>\r\n    <div class="bk-payment-wrap">\r\n        <template v-for="payment in payments" :key="payment.code">\r\n            <div class="bk-payment">\r\n                <div class="bk-payment-inner">\r\n                    <router-link\r\n                            :title="$tc(\'buckaroo-payment.configure-payment\')"\r\n                            :to="{ name: \'buckaroo.payment.config\', params: { namespace: \'BuckarooPayments\', paymentCode: payment.code } }"\r\n                    >\r\n                        <div class="bk-payment-img">\r\n                            <img :src="assetFilter(`buckaroopayments/administration/static/${payment.logo}`)" alt="Payment logo">\r\n                        </div>\r\n                        <div class="bk-payment-name">\r\n                            {{ getPaymentTitle(payment.code) }}\r\n                        </div>\r\n                    </router-link>\r\n                    <buckaroo-toggle-status\r\n                            :currentSalesChannelId="currentSalesChannelId"\r\n                            :method="payment.code"\r\n                            v-model="value"\r\n                    />\r\n                    <router-link\r\n                            class="bk-link"\r\n                            :title="$tc(\'buckaroo-payment.configure-payment\')"\r\n                            :to="{ name: \'buckaroo.payment.config\', params: { namespace: \'BuckarooPayments\', paymentCode: payment.code } }"\r\n                    >\r\n                        {{ $tc(\'buckaroo-payment.configure-link\') }}\r\n                    </router-link>\r\n                </div>\r\n            </div>\r\n        </template>\r\n    </div>\r\n</sw-card>\r\n',props:{configSettings:{required:!0},value:{required:!0},currentSalesChannelId:{required:!0}},data(){return{payments:[{code:"Alipay",logo:"alipay.svg"},{code:"applepay",logo:"applepay.svg"},{code:"bancontactmrcash",logo:"bancontact.svg"},{code:"belfius",logo:"belfius.svg"},{code:"Billink",logo:"billink.svg"},{code:"creditcard",logo:"creditcards.svg"},{code:"creditcards",logo:"creditcards.svg"},{code:"eps",logo:"eps.svg"},{code:"giftcards",logo:"giftcards.svg"},{code:"giropay",logo:"giropay.svg"},{code:"idealqr",logo:"ideal-qr.svg"},{code:"ideal",logo:"ideal.svg"},{code:"capayable",logo:"ideal-in3.svg"},{code:"KBCPaymentButton",logo:"kbc.svg"},{code:"klarnakp",logo:"klarna.svg"},{code:"knaken",logo:"knaken.svg"},{code:"mbway",logo:"mbway.svg"},{code:"multibanco",logo:"multibanco.svg"},{code:"paybybank",logo:"paybybank.gif"},{code:"payconiq",logo:"payconiq.svg"},{code:"paypal",logo:"paypal.svg"},{code:"payperemail",logo:"payperemail.svg"},{code:"Przelewy24",logo:"przelewy24.svg"},{code:"afterpay",logo:"afterpay.svg"},{code:"sofortueberweisung",logo:"sofort.svg"},{code:"sepadirectdebit",logo:"sepa-directdebit.svg"},{code:"transfer",logo:"sepa-credittransfer.svg"},{code:"Trustly",logo:"trustly.svg"},{code:"WeChatPay",logo:"wechatpay.svg"}]}},methods:{getPaymentTitle(e){let t=this.payments.find(t=>t.code===e);return t?t.code:"Unknown Payment"},assetFilter(e){return _.getByName("asset")(e)}}});let{Component:w,Mixin:C}=Shopware;w.register("buckaroo-test-credentials",{template:'        <sw-button @click="sendTestApi" :disabled="!enabled" variant="primary" :square="false" :block="true" :isLoading="isLoading">{{ $tc(\'buckaroo-payment.button.labelTestApi\') }}</sw-button>',mixins:[C.getByName("notification"),C.getByName("sw-inline-snippet")],data(){return{isLoading:!1}},inject:["BuckarooPaymentSettingsService"],props:{config:{type:Object,required:!0},currentSalesChannelId:{required:!0}},computed:{enabled:function(){return(this.getConfigValue("websiteKey")||"").length>0&&(this.getConfigValue("secretKey")||"").length>0}},methods:{getConfigValue:function(e){return console.log(this.config),this.config["BuckarooPayments.config."+e]},sendTestApi(){this.isLoading=!0;let e=this.getConfigValue("websiteKey"),t=this.getConfigValue("secretKey");this.BuckarooPaymentSettingsService.getApiTest(e,t,this.currentSalesChannelId).then(e=>{this.isLoading=!1,"success"==e.status?this.createNotificationSuccess({title:this.$tc("buckaroo-payment.settingsForm.titleSuccess"),message:this.$tc(e.message)}):this.createNotificationError({title:this.$tc("buckaroo-payment.settingsForm.titleError"),message:this.$tc(e.message)})}).catch(()=>{this.isLoading=!1})}}}),a(276);let{Component:T,Mixin:S}=Shopware;T.register("buckaroo-toggle-status",{template:'<div class="bk-toogle-wrap">\r\n    <button type="button" :disabled="isLoading" :class="`live ${getClass(\'live\')}`" @click="setStatus(\'live\')">Live</button>\r\n    <button type="button" :disabled="isLoading" :class="`test ${getClass(\'test\')}`" @click="setStatus(\'test\')">Test</button>\r\n    <button type="button" :disabled="isLoading" :class="`disabled ${getClass(\'disabled\')}`" @click="setStatus(\'disabled\')">Off</button>\r\n</div>',props:{method:{type:String,required:!0},value:{required:!0},currentSalesChannelId:{required:!0}},mixins:[S.getByName("notification")],inject:["systemConfigApiService"],data(){return{status:this.getStatus(),isLoading:!1}},watch:{value(){this.status=this.getStatus()}},methods:{getStatus(){return this.isActive()?this.getEnvironment():"disabled"},isActive(){return this.getValueForName(`${this.method}Enabled`)},getEnvironment(){let e=this.getValueForName(`${this.method}Environment`);return void 0===e?"test":e},getValueForName(e){return this.value?.[`BuckarooPayments.config.${e}`]},setStatus(e){this.status=e,this.saveStatus()},getClass(e){return this.status===e?"active":""},async saveStatus(){let e=`BuckarooPayments.config.${this.method}Enabled`,t=`BuckarooPayments.config.${this.method}Environment`,a={[e]:!1};this.$set(this.value,e,!1),-1!==["live","test"].indexOf(this.status)&&(a={[e]:!0,[t]:this.status},this.$set(this.value,e,!0),this.$set(this.value,t,this.status)),this.isLoading=!0;try{await this.systemConfigApiService.batchSave({[this.currentSalesChannelId]:a}).finally(()=>{this.isLoading=!1}),this.renderSuccess()}catch(e){this.renderError(e)}},renderSuccess(){this.createNotificationSuccess({message:this.$tc("sw-extension-store.component.sw-extension-config.messageSaveSuccess")})},renderError(e){this.createNotificationError({message:e})}}})}()})();