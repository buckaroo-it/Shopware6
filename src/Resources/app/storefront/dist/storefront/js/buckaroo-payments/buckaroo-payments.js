(()=>{"use strict";var e={156:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==r},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s(Array.isArray(e)?[]:{},e,t):e}function i(e,t,r){return e.concat(t).map(function(e){return n(e,r)})}function o(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function a(e,t){try{return t in e}catch(e){return!1}}function s(e,r,l){(l=l||{}).arrayMerge=l.arrayMerge||i,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=n;var c,d,u=Array.isArray(r);return u!==Array.isArray(e)?n(r,l):u?l.arrayMerge(e,r,l):(d={},(c=l).isMergeableObject(e)&&o(e).forEach(function(t){d[t]=n(e[t],c)}),o(r).forEach(function(t){(!a(e,t)||Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))&&(a(e,t)&&c.isMergeableObject(r[t])?d[t]=(function(e,t){if(!t.customMerge)return s;var r=t.customMerge(e);return"function"==typeof r?r:s})(t,c)(e[t],r[t],c):d[t]=n(r[t],c))}),d)}s.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,r){return s(e,r,t)},{})},e.exports=s}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n=r(156),i=r.n(n);class o{static ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static lcFirst(e){return e.charAt(0).toLowerCase()+e.slice(1)}static toDashCase(e){return e.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(e,t){let r=o.toUpperCamelCase(e,t);return o.lcFirst(r)}static toUpperCamelCase(e,t){return t?e.split(t).map(e=>o.ucFirst(e.toLowerCase())).join(""):o.ucFirst(e.toLowerCase())}static parsePrimitive(e){try{return/^\d+(.|,)\d+$/.test(e)&&(e=e.replace(",",".")),JSON.parse(e)}catch(t){return e.toString()}}}class a{constructor(e=document){this._el=e,e.$emitter=this,this._listeners=[]}publish(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new CustomEvent(e,{detail:t,cancelable:r});return this.el.dispatchEvent(n),n}subscribe(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this,i=e.split("."),o=r.scope?t.bind(r.scope):t;if(r.once&&!0===r.once){let t=o;o=function(r){n.unsubscribe(e),t(r)}}return this.el.addEventListener(i[0],o),this.listeners.push({splitEventName:i,opts:r,cb:o}),!0}unsubscribe(e){let t=e.split(".");return this.listeners=this.listeners.reduce((e,r)=>([...r.splitEventName].sort().toString()===t.sort().toString()?this.el.removeEventListener(r.splitEventName[0],r.cb):e.push(r),e),[]),!0}reset(){return this.listeners.forEach(e=>{this.el.removeEventListener(e.splitEventName[0],e.cb)}),this.listeners=[],!0}get el(){return this._el}set el(e){this._el=e}get listeners(){return this._listeners}set listeners(e){this._listeners=e}}class s{constructor(e,t={},r=!1){if(!(e instanceof Node)){console.warn(`There is no valid element given while trying to create a plugin instance for "${r}".`);return}this.el=e,this.$emitter=new a(this.el),this._pluginName=this._getPluginName(r),this.options=this._mergeOptions(t),this._initialized=!1,this._registerInstance(),this._init()}init(){console.warn(`The "init" method for the plugin "${this._pluginName}" is not defined. The plugin will not be initialized.`)}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(e){let t=[this.constructor.options,this.options,e];return t.push(this._getConfigFromDataAttribute()),t.push(this._getOptionsFromDataAttribute()),i().all(t.filter(e=>e instanceof Object&&!(e instanceof Array)).map(e=>e||{}))}_getConfigFromDataAttribute(){let e={};if("function"!=typeof this.el.getAttribute)return e;let t=o.toDashCase(this._pluginName),r=this.el.getAttribute(`data-${t}-config`);return r?window.PluginConfigManager.get(this._pluginName,r):e}_getOptionsFromDataAttribute(){let e={};if("function"!=typeof this.el.getAttribute)return e;let t=o.toDashCase(this._pluginName),r=this.el.getAttribute(`data-${t}-options`);if(r)try{return JSON.parse(r)}catch(e){console.error(`The data attribute "data-${t}-options" could not be parsed to json: ${e.message}`)}return e}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(e){return e||(e=this.constructor.name),e}}class l{constructor(){this._request=null,this._errorHandlingInternal=!1}get(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",n=this._createPreparedRequest("GET",e,r);return this._sendRequest(n,null,t)}post(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";n=this._getContentType(t,n);let i=this._createPreparedRequest("POST",e,n);return this._sendRequest(i,t,r)}delete(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";n=this._getContentType(t,n);let i=this._createPreparedRequest("DELETE",e,n);return this._sendRequest(i,t,r)}patch(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";n=this._getContentType(t,n);let i=this._createPreparedRequest("PATCH",e,n);return this._sendRequest(i,t,r)}abort(){if(this._request)return this._request.abort()}setErrorHandlingInternal(e){this._errorHandlingInternal=e}_registerOnLoaded(e,t){t&&(!0===this._errorHandlingInternal?(e.addEventListener("load",()=>{t(e.responseText,e)}),e.addEventListener("abort",()=>{console.warn(`the request to ${e.responseURL} was aborted`)}),e.addEventListener("error",()=>{console.warn(`the request to ${e.responseURL} failed with status ${e.status}`)}),e.addEventListener("timeout",()=>{console.warn(`the request to ${e.responseURL} timed out`)})):e.addEventListener("loadend",()=>{t(e.responseText,e)}))}_sendRequest(e,t,r){return this._registerOnLoaded(e,r),e.send(t),e}_getContentType(e,t){return e instanceof FormData&&(t=!1),t}_createPreparedRequest(e,t,r){return this._request=new XMLHttpRequest,this._request.open(e,t),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),r&&this._request.setRequestHeader("Content-type",r),this._request}}class c extends s{static #e=this.options={page:"unknown",merchantId:null};init(){null===this.merchantId&&alert("Merchant id is required"),document.$emitter.subscribe("buckaroo_scripts_loaded",()=>{this.sdk=BuckarooSdk.PayPal,this.sdk.initiate(this.sdkOptions)})}onShippingChangeHandler(e,t){return this.setShipping(e).then(e=>{if(!1===e.error)return this.cartToken=e.token,this.sdkOptions.amount=e.cart.value,t.order.patch([{op:"replace",path:"/purchase_units/@reference_id=='default'/amount",value:e.cart}]);this.displayErrorMessage(e.message),t.reject(e.message)})}createPaymentHandler(e){return this.createTransaction(e.orderID)}onSuccessCallback(){!0===this.result.error?this.displayErrorMessage(message):this.result.redirect?window.location=this.result.redirect:this.displayErrorMessage(this.options.i18n.cannot_create_payment)}onErrorCallback(e){this.displayErrorMessage(e)}onCancelCallback(){this.displayErrorMessage(this.options.i18n.cancel_error_message)}onClickCallback(){this.result=null}createTransaction(e){let t={orderId:e};return this.cartToken&&(t.cartToken=this.cartToken),new Promise(e=>{this.httpClient.post(`${this.url}/paypal/pay`,JSON.stringify(t),t=>{this.result=JSON.parse(t),e(JSON.parse(t))})})}getFormData(){let e=document.getElementById("productDetailPageBuyProductForm");if(!e)return console.error("Product form not found"),null;let t=new FormData(e),r={};return t.forEach((e,t)=>{r[t]=e}),r}setShipping(e){let t={};"product"!==this.options.page||(t=this.getFormData())||console.error("[Buckaroo] Form element not found on product page.");let r={form:t,customer:e,page:this.options.page};return new Promise(e=>{this.httpClient.post(`${this.url}/paypal/create`,JSON.stringify(r),t=>{e(JSON.parse(t))})})}displayErrorMessage(e){$(".buckaroo-paypal-express-error").remove(),"object"==typeof e&&(e=this.options.i18n.cannot_create_payment);let t=`
        <div role="alert" class="alert alert-warning alert-has-icon buckaroo-paypal-express-error">
            <span class="icon icon-warning">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24"><defs><path d="m13.7744 1.4124 9.7058 18.6649c.5096.98.1283 2.1875-.8517 2.6971a2 2 0 0 1-.9227.2256H2.2942c-1.1045 0-2-.8954-2-2a2 2 0 0 1 .2256-.9227l9.7058-18.665c.5096-.98 1.7171-1.3613 2.6971-.8517a2 2 0 0 1 .8517.8518zM2.2942 21h19.4116L12 2.335 2.2942 21zM12 17c.5523 0 1 .4477 1 1s-.4477 1-1 1-1-.4477-1-1 .4477-1 1-1zm1-2c0 .5523-.4477 1-1 1s-1-.4477-1-1v-5c0-.5523.4477-1 1-1s1 .4477 1 1v5z" id="icons-default-warning"></path></defs><use xlink:href="#icons-default-warning" fill="#758CA3" fill-rule="evenodd"></use></svg>
            </span>                                    
            <div class="alert-content-container"> 
                <div class="alert-content">
                    ${e}
                </div>
                
            </div>
        </div>
        `;$(".flashbags").first().prepend(t),setTimeout(function(){$(".buckaroo-paypal-express-error").fadeOut(1e3)},1e4)}constructor(...e){super(...e),this.httpClient=new l,this.url="/buckaroo",this.result=null,this.sdkOptions={containerSelector:".buckaroo-paypal-express",buckarooWebsiteKey:this.options.websiteKey,paypalMerchantId:this.options.merchantId,currency:"EUR",amount:.1,createPaymentHandler:this.createPaymentHandler.bind(this),onShippingChangeHandler:this.onShippingChangeHandler.bind(this),onSuccessCallback:this.onSuccessCallback.bind(this),onErrorCallback:this.onErrorCallback.bind(this),onCancelCallback:this.onCancelCallback.bind(this),onClickCallback:this.onClickCallback.bind(this)}}}class d extends s{static #e=this.options={page:"unknown",merchantId:null,websiteKey:null,i18n:{cancel_error_message:"Payment was cancelled.",cannot_create_payment:"Cannot create the payment. Please try again.",customer_not_found:"You must be logged in to perform this action.",general_error:"An error occurred while processing your payment."}};init(){let e=document.querySelector("[data-buckaroo-ideal-fast-checkout-plugin-options]");if(!e){console.error("Plugin options element not found");return}let t=e.getAttribute("data-buckaroo-ideal-fast-checkout-plugin-options");if(!t){console.error("No data found in plugin options");return}let r=JSON.parse(t);this.options.page=r.page;let n=document.getElementById("fast-checkout-ideal-btn");if(!n){console.error("Ideal Fast Checkout button not found");return}n.addEventListener("click",e=>this.initPayment(e))}initPayment(e){e.preventDefault();let t=document.getElementById("fast-checkout-ideal-btn");t&&t.setAttribute("disabled","disabled"),this.createCart().finally(()=>{t&&t.removeAttribute("disabled")})}createCart(){let e={};if("product"===this.options.page&&(e=this.getFormData()),!e){console.error("Form data could not be retrieved");return}return this.sendPostRequest(`${this.url}/idealfastcheckout/pay`,{form:e,page:this.options.page}).then(e=>{if(e.redirect)window.location=e.redirect;else if(e.errorCode)this.handleErrorResponse(e);else{let t=e.message||this.options.i18n.cannot_create_payment;this.displayErrorMessage(t)}}).catch(e=>{console.error("Error creating cart:",e),this.displayErrorMessage(this.options.i18n.general_error)})}handleErrorResponse(e){let t=e.message||this.options.i18n.general_error;"CUSTOMER_NOT_FOUND"===e.errorCode&&(t=this.options.i18n.customer_not_found),this.displayErrorMessage(t)}getFormData(){let e=document.getElementById("productDetailPageBuyProductForm");if(!e)return console.error("Product form not found"),null;let t=new FormData(e),r={};return t.forEach((e,t)=>{r[t]=e}),r}sendPostRequest(e,t){return new Promise((r,n)=>{this.httpClient.post(e,JSON.stringify(t),e=>{try{let t=JSON.parse(e);r(t)}catch(e){console.error("Error parsing response:",e),n(e)}})})}displayErrorMessage(e){let t=document.createElement("div");t.className="buckaroo-idealfastcheckout-express-error alert alert-warning alert-has-icon",t.innerHTML=`
            <span class="icon icon-warning">!</span>
            <div class="alert-content">
                ${e}
            </div>
        `;let r=document.querySelector(".flashbags");r&&(r.prepend(t),setTimeout(()=>t.remove(),1e4))}constructor(...e){super(...e),this.httpClient=new l,this.url="/buckaroo",this.result=null,this.cartToken=null}}class u extends s{static #e=this.options={orderId:null,pullUrl:null,interval:5e3};init(){this.pullStatus()}pullStatus(){setInterval(this.singlePullStatus.bind(this),this.options.interval)}singlePullStatus(){this.options,this.httpClient.post(this.options.pullUrl,JSON.stringify({orderId:this.options.orderId}),e=>{let t=JSON.parse(e);void 0!==t.redirectUrl&&(window.location.href=t.redirectUrl)})}constructor(...e){super(...e),this.httpClient=new l}}let h="bk-is-mobile",m="bk-paybybank-selected";class p extends s{static #e=this.options={issuerSelected:""};init(){this.listenToIsMobile(),this.onPageLoad(),this.listenToResize(),this.listenToIssuerChange(),this.togglePayByBankList(),this.emitSavedIssuer()}emitSavedIssuer(){"string"==typeof this.options.issuerSelected&&this.options.issuerSelected.length>0&&document.$emitter.publish(m,{code:this.options.issuerSelected,source:"other"})}onPageLoad(){document.$emitter.publish(h,{isMobile:768>(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)})}listenToResize(){window.addEventListener("resize",(function(){let e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=!1;e<768&&(t=!0),this.isMobile!==t&&document.$emitter.publish(h,{isMobile:t})}).bind(this))}listenToIsMobile(){document.$emitter.subscribe(h,(function(e){this.isMobile=e.detail.isMobile,this.toggleInputType()}).bind(this))}toggleInputType(){let e=document.querySelector(".bk-paybybank-mobile"),t=document.querySelector(".bk-paybybank-not-mobile");this.isMobile&&e&&t?(e.style.display="block",t.style.display="none"):(e.style.display="none",t.style.display="block")}togglePayByBankList(){this._elementsToShow=document.querySelectorAll(".bk-paybybank-selector .custom-radio:nth-child(n+6)"),setTimeout(()=>{let e=localStorage.getItem("confirmOrderForm.payBybankMethod");null!==e&&document.$emitter.publish(m,{code:e,source:"other"})},300),this.toggleElements(!1),this.el.addEventListener("click",(function(e){let t=document.querySelector(".bk-toggle-wrap");if(null===t)return;let r=t.querySelector(".bk-toggle-text");if(e.target===r){let e=t.querySelector(".bk-toggle"),n=e.classList.contains("bk-toggle-down");e.classList.toggle("bk-toggle-down"),e.classList.toggle("bk-toggle-up");let i=r.getAttribute("text-less"),o=r.getAttribute("text-more");n?r.textContent=i:r.textContent=o,this.toggleElements(n)}}).bind(this))}listenToIssuerChange(){let e=function(){let e=document.querySelector(".bk-toggle-wrap");if(null!==e){let t=e.querySelector(".bk-toggle-text"),r=e.querySelector(".bk-toggle"),n=r.classList.contains("bk-toggle-down"),i=t.getAttribute("text-more");n||(r.classList.toggle("bk-toggle-down"),r.classList.toggle("bk-toggle-up"),t.textContent=i)}};document.$emitter.subscribe(m,(function(e){this.syncInputs(e.detail)}).bind(this)),document.querySelector("#payBybankMethod").addEventListener("change",function(t){document.$emitter.publish(m,{code:t.target.value,source:"select"}),e()}),document.querySelectorAll(".bk-paybybank-radio input").forEach(function(e){e.addEventListener("change",function(e){document.$emitter.publish(m,{code:e.target.value,source:"radio"})})})}syncInputs(e){this._elementsToShow=document.querySelectorAll(`.bk-paybybank-selector .custom-radio:not(.bankMethod${e.code})`),"other"===e.source&&this.toggleElements(!1),-1!==["radio","other"].indexOf(e.source)&&(document.querySelector("#payBybankMethod").value=e.code),-1===["select","other"].indexOf(e.source)||(document.querySelectorAll(".bk-paybybank-radio").forEach(function(t){let r=t.querySelector("input");t.style.display="none",null!==r&&(r.checked=!1,r.value===e.code&&(r.checked=!0,t.style.display="block"))}),e.code&&0!==e.code.length||this.showDefaultsIfEmptyIssuer())}showDefaultsIfEmptyIssuer(){document.querySelectorAll(".bk-paybybank-selector .custom-radio:nth-child(-n+5)").forEach(function(e){e.style.display="block"})}toggleElements(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inline";this._elementsToShow.forEach(function(r){r.style.display=e?t:"none"})}constructor(...e){super(...e),this.httpClient=new l}}class b extends s{static #e=this.options={issuerSelected:"",issuerLogos:[]};init(){this.initialLogo(),this.listenToIssuerChange()}listenToIssuerChange(){document.$emitter.subscribe("bk-paybybank-selected",(function(e){this.updateLogo(e.detail.code)}).bind(this))}initialLogo(){this.updateLogo(this.options.issuerSelected)}updateLogo(e){if(this.options.issuerLogos[e]){let t=document.querySelector(".bk-paybybank .payment-method-image");t&&(t.src=this.options.issuerLogos[e])}}}let y=window.PluginManager;"BuckarooPaymentValidateSubmit"in window.PluginManager.getPluginList()||(y.register("BuckarooPaymentValidateSubmit",class e extends s{init(){try{this._registerCheckoutSubmitButton(),this._toggleApplePay(),this._getActivePayByBankLogo()}catch(e){console.log("init error",e)}}_getActivePayByBankLogo(){let e=document.querySelector(".bk-paybybank .payment-method-image"),t=document.querySelector(".bk-paybybank-active-logo");e&&t&&t.value&&t.value.length>0&&(e.src=t.value)}_toggleApplePay(){let e=document.querySelector(".payment-method.bk-applepay");if(e){let t=async function(e){return"ApplePaySession"in window&&void 0!==ApplePaySession?await ApplePaySession.canMakePaymentsWithActiveCard(e):Promise.resolve(!1)};(async function(){let r=document.getElementById("bk-apple-merchant-id");if(r&&r.value.length>0){let n=await t(r);e.style.display=n?"block":"none"}})().catch()}}_registerCheckoutSubmitButton(){let e=document.getElementById("confirmOrderForm");e&&e.querySelector('[type="submit"]').addEventListener("click",this._handleCheckoutSubmit.bind(this))}_handleCheckoutSubmit(e){e.preventDefault(),document.$emitter.unsubscribe("buckaroo_payment_validate"),this._listenToValidation(),document.$emitter.publish("buckaroo_payment_submit")}_listenToValidation(){let e={general:this._deferred(),credicard:this._deferred()};document.$emitter.subscribe("buckaroo_payment_validate",function(t){t.detail.type&&e[t.detail.type]&&e[t.detail.type].resolve(t.detail.valid)}),Promise.all([e.general,e.credicard]).then(function(e){let[t,r]=e;void 0!==document.forms.confirmOrderForm&&document.forms.confirmOrderForm.reportValidity()&&(t&&r?(void 0!==window.buckaroo_back_link&&window.history.pushState(null,null,buckaroo_back_link),window.isApplePay||document.forms.confirmOrderForm.submit()):document.getElementById("changePaymentForm").scrollIntoView())})}_deferred(){let e,t;let r=new Promise((r,n)=>{[e,t]=[r,n]});return r.resolve=e,r.reject=t,r}}),y.register("BuckarooPaymentCreditcards",class e extends s{init(){this._listenToSubmit(),this._createScript(()=>{for(let e of["creditcards_issuer","creditcards_cardholdername","creditcards_cardnumber","creditcards_expirationmonth","creditcards_expirationyear","creditcards_cvc"]){let t=document.getElementById(e);t&&t.addEventListener("change",this._handleInputChanged.bind(this))}let e=document.getElementById("creditcards_issuer");e&&document.getElementById("card_kind_img").setAttribute("src",e.options[e.selectedIndex].getAttribute("data-logo")),this._getEncryptedData()})}_createScript(e){let t=document.createElement("script");t.type="text/javascript",t.src="https://static.buckaroo.nl/script/ClientSideEncryption001.js",t.addEventListener("load",e.bind(this),!1),document.head.appendChild(t)}_getEncryptedData(){let e=document.getElementById("creditcards_cardnumber"),t=document.getElementById("creditcards_expirationyear"),r=document.getElementById("creditcards_expirationmonth"),n=document.getElementById("creditcards_cvc"),i=document.getElementById("creditcards_cardholdername");if(e&&t&&r&&n&&i){var o,a,s,l,c;o=e.value,a=t.value,s=r.value,l=n.value,c=i.value,window.BuckarooClientSideEncryption.V001.encryptCardData(o,a,s,l,c,function(e){let t=document.getElementById("encryptedCardData");t&&(t.value=e)})}}_handleInputChanged(e){let t=e.target.id,r=document.getElementById(t);"creditcards_issuer"===t?document.getElementById("card_kind_img").setAttribute("src",r.options[r.selectedIndex].getAttribute("data-logo")):this._CheckValidate(),this._getEncryptedData()}_handleCheckField(e){switch(document.getElementById(e.id+"Error").style.display="none",e.id){case"creditcards_cardnumber":if(!window.BuckarooClientSideEncryption.V001.validateCardNumber(e.value.replace(/\s+/g,"")))return document.getElementById(e.id+"Error").style.display="block",!1;break;case"creditcards_cardholdername":if(!window.BuckarooClientSideEncryption.V001.validateCardholderName(e.value))return document.getElementById(e.id+"Error").style.display="block",!1;break;case"creditcards_cvc":if(!window.BuckarooClientSideEncryption.V001.validateCvc(e.value))return document.getElementById(e.id+"Error").style.display="block",!1;break;case"creditcards_expirationmonth":if(!window.BuckarooClientSideEncryption.V001.validateMonth(e.value))return document.getElementById(e.id+"Error").style.display="block",!1;break;case"creditcards_expirationyear":if(!window.BuckarooClientSideEncryption.V001.validateYear(e.value))return document.getElementById(e.id+"Error").style.display="block",!1}return!0}_CheckValidate(){let e=!1;for(let t of["creditcards_cardholdername","creditcards_cardnumber","creditcards_expirationmonth","creditcards_expirationyear","creditcards_cvc"]){let r=document.getElementById(t);r&&!this._handleCheckField(r)&&(e=!0)}return this._disableConfirmFormSubmit(e)}_disableConfirmFormSubmit(e){return document.getElementById("confirmFormSubmit")&&(document.getElementById("confirmFormSubmit").disabled=e),e}_registerCheckoutSubmitButton(){let e=document.getElementById("confirmFormSubmit");e&&e.addEventListener("click",this._handleCheckoutSubmit.bind(this))}_validateOnSubmit(e){e.preventDefault();let t=!this._CheckValidate();document.$emitter.publish("buckaroo_payment_validate",{valid:t,type:"credicard"})}_listenToSubmit(){document.$emitter.subscribe("buckaroo_payment_submit",this._validateOnSubmit.bind(this))}}),y.register("BuckarooPaymentCreditcard",class e extends s{init(){document.getElementById("tailwind-wrapper-creditcards")&&this._loadHostedFieldsScript(()=>{this._initializeHostedFields(),this._listenToSubmit()})}_loadHostedFieldsScript(e){if(document.getElementById("buckaroo-sdk"))e();else{let t=document.createElement("script");t.id="buckaroo-sdk",t.src="https://hostedfields-externalapi.prod-pci.buckaroo.io/v1/sdk",t.addEventListener("load",e.bind(this),!1),document.head.appendChild(t)}}async _initializeHostedFields(){try{let e=await this._getOrRefreshToken();if(!e||!e.access_token){console.error("Failed to retrieve Buckaroo OAuth token.");return}let t=e.access_token;this.sdkClient=new BuckarooHostedFieldsSdk.HFClient(t),this.sdkClient.setLanguage("en"),await this.sdkClient.setSupportedServices(e.issuers);let r=document.getElementById("selected-issuer"),n=document.getElementById("pay"),i="";await this.sdkClient.startSession(e=>{this.sdkClient.handleValidation(e,"cc-name-error","cc-number-error","cc-expiry-error","cc-cvc-error"),n&&this._updateButtonState(n),i=this.sdkClient.getService(),r.value=i});let o={height:"80%",position:"absolute",border:"1px solid gray",radius:"5px",opacity:"1",transition:"all 0.3s ease",right:"5px",backgroundColor:"inherit"},a={fontSize:"14px",fontFamily:"Consolas, Liberation Mono, Menlo, Courier, monospace",textAlign:"left",background:"inherit",color:"black",placeholderColor:"grey",cardLogoStyling:o};await this.sdkClient.mountCardHolderName("#cc-name-wrapper",{id:"ccname",placeHolder:"John Doe",labelSelector:"#cc-name-label",baseStyling:a}).then(e=>e.focus()),await this.sdkClient.mountCardNumber("#cc-number-wrapper",{id:"cc",placeHolder:"555x xxxx xxxx xxxx",labelSelector:"#cc-number-label",baseStyling:a,cardLogoStyling:o}),await this.sdkClient.mountCvc("#cc-cvc-wrapper",{id:"cvc",placeHolder:"1234",labelSelector:"#cc-cvc-label",baseStyling:a}),await this.sdkClient.mountExpiryDate("#cc-expiry-wrapper",{id:"expiry",placeHolder:"MM / YY",labelSelector:"#cc-expiry-label",baseStyling:a})}catch(e){console.error("Error initializing Buckaroo Hosted Fields:",e)}}async _handleSubmit(e){e.preventDefault();try{let e=await this.sdkClient.submitSession();if(!e){console.error("Failed to retrieve Hosted Fields token.");return}let t=document.getElementById("buckaroo-token");t&&(t.value=e),document.getElementById("confirmOrderForm").submit()}catch(e){console.error("Error processing Buckaroo payment:",e)}}_listenToSubmit(){let e=document.getElementById("pay");e&&e.addEventListener("click",this._handleSubmit.bind(this));let t=document.getElementById("tos")||document.querySelector(".checkout-confirm-tos-checkbox");t&&e&&t.addEventListener("change",()=>{this._updateButtonState(e)})}_updateButtonState(e){if(!e)return;let t=this.sdkClient&&this.sdkClient.formIsValid(),r=document.getElementById("tos")||document.querySelector(".checkout-confirm-tos-checkbox"),n=!r||r.checked,i=!t||!n;e.disabled=i,e.style.backgroundColor=i?"#ff5555":"",e.style.cursor=i?"not-allowed":"",e.style.opacity=i?"0.5":""}_getStorefrontBaseUrl(){let e=window.location.origin,t=window.location.pathname.split("/").filter(Boolean);return t.length>0&&/^[a-z]{2}(-[A-Z]{2})?$/i.test(t[0])?`${e}/${t[0]}`:e}async _getOrRefreshToken(){let e=Date.now();if(this.tokenExpiresAt&&e<this.tokenExpiresAt&&this.accessToken)return{access_token:this.accessToken,issuers:this.issuers};try{let t=this._getStorefrontBaseUrl(),r=await fetch(`${t}/buckaroo/get-oauth-token`,{method:"GET",headers:{"X-Requested-From":"ShopwareFrontend"}}),n=await r.json();if(!n||!n.data.access_token)throw Error("No access token in response");return this.accessToken=n.data.access_token,this.issuers=n.data.issuers,this.tokenExpiresAt=e+6e5,{access_token:this.accessToken,issuers:this.issuers}}catch(e){return console.error("Token refresh failed:",e),null}}}),y.register("BuckarooPaymentHelper",class e extends s{get buckarooInputs(){return["buckaroo_capayablein3_OrderAs"]}get buckarooMobileInputs(){return["buckarooAfterpayPhone","buckarooIn3Phone","buckarooBillinkPhone"]}get buckarooDoBInputs(){return["buckaroo_afterpay_DoB","buckaroo_capayablein3_DoB","buckaroo_billink_DoB"]}init(){try{this._registerEvents()}catch(e){console.log("init error",e)}}_registerEvents(){for(let e of(this._checkCompany(),this._listenToSubmit(),this.buckarooInputs)){let t=document.getElementById(e);t&&t.addEventListener("change",this._handleInputChanged.bind(this))}for(let e of this.buckarooMobileInputs){let t=document.getElementById(e);t&&t.addEventListener("change",this._handleMobileInputChanged.bind(this))}for(let e of this.buckarooDoBInputs){let t=document.getElementById(e);t&&t.addEventListener("change",this._handleDoBInputChanged.bind(this))}let e=document.getElementById("P24Currency");e&&"PLN"!=e.value&&(document.getElementById("confirmFormSubmit").disabled=!0,document.getElementById("P24CurrencyError").style.display="block")}_checkCompany(){let e=document.getElementById("buckaroo_capayablein3_OrderAs"),t="none",r=!1;e&&e.selectedIndex>0&&(r=!0,t="block");let n=document.getElementById("buckaroo_capayablein3_COCNumberDiv");return n&&(n.style.display=t,document.getElementById("buckaroo_capayablein3_CompanyNameDiv").style.display=t,document.getElementById("buckaroo_capayablein3_COCNumber").required=r,document.getElementById("buckaroo_capayablein3_CompanyName").required=r),r}_handleInputChanged(e){"buckaroo_capayablein3_OrderAs"===e.target.id&&this._checkCompany()}_handleMobileInputChanged(){this._CheckValidate()}_handleDoBInputChanged(){this._CheckValidate()}_CheckValidate(){let e=!1;for(let t of this.buckarooMobileInputs){let r=document.getElementById(t);r&&!this._handleCheckMobile(r)&&(e=!0)}for(let t of this.buckarooDoBInputs){let r=document.getElementById(t);r&&!this._handleCheckDoB(r)&&(e=!0)}return this._disableConfirmFormSubmit(e)}_handleCheckMobile(e){let t=document.getElementById("buckarooMobilePhoneError");return t&&(t.style.display="none"),!!e.value.match(/^\d{10}$/)||(t&&(t.style.display="block"),!1)}_handleCheckDoB(e){let t=document.getElementById("buckarooDoBError");t&&(t.style.display="none");let r=new Date(Date.parse(e.value));return!("Invalid Date"==r||new Date().getFullYear()-r.getFullYear()<18||1900>r.getFullYear())||(t&&(t.style.display="block"),!1)}_disableConfirmFormSubmit(e){return document.getElementById("confirmFormSubmit")&&(document.getElementById("confirmFormSubmit").disabled=e),e}_handleCompanyName(){let e=document.getElementById("buckaroo_capayablein3_CompanyNameError");return e.style.display="none",!!document.getElementById("buckaroo_capayablein3_CompanyName").value.length||(e.style.display="block",!1)}_isRadioOrCeckbox(e){return"radio"==e.type||"checkbox"==e.type}radioGroupHasRequired(e){let t=e.querySelectorAll('input[type="radio"]');return!!t&&[...t].filter(function(e){return e.checked}).length>0}isRadioGroup(e){return e.classList.contains("radio-group-required")}_handleRequired(){let e=document.getElementById("changePaymentForm").querySelectorAll("[required]");e&&e.length&&e.forEach(e=>{let t=e.parentElement;if("radio"===e.type&&(t=t.parentElement),t){let r=t.querySelector('[class="buckaroo-required"]');this.isRadioGroup(e)&&this.radioGroupHasRequired(e)?r&&r.remove():this._isRadioOrCeckbox(e)&&e.checked?r&&r.remove():this._isRadioOrCeckbox(e)||this.isRadioGroup(e)||!(e.value.length>0)?null===r&&(r=this._createMessageElement(e),null===t.querySelector('[id$="Error"]')&&t.append(r)):r&&r.remove()}})}_createMessageElement(e){let t=buckaroo_required_message,r=e.getAttribute("required-message");null!=r&&r.length&&(t=r);let n=document.createElement("label");return n.setAttribute("for",e.id),n.classList.add("buckaroo-required"),n.style.color="red",n.style.width="100%",n.innerHTML=t,n}_validateOnSubmit(){let e=!0;for(let t of(this._handleRequired(),document.querySelectorAll(".radio-group-required")))e=e&&this.radioGroupHasRequired(t);for(let t of this.buckarooMobileInputs)document.getElementById(t)&&(e=e&&!this._CheckValidate());for(let t of this.buckarooDoBInputs)document.getElementById(t)&&(e=e&&!this._CheckValidate());document.$emitter.publish("buckaroo_payment_validate",{valid:e,type:"general"})}_listenToSubmit(){document.$emitter.subscribe("buckaroo_payment_submit",this._validateOnSubmit.bind(this));let e=document.getElementById("confirmFormSubmit");e&&e.addEventListener("click",t=>{e.disabled=!0,setTimeout(()=>{this._CheckValidate()&&(e.disabled=!1)},2e3)})}}),y.register("PaypalExpressPlugin",c,"[data-paypal-express]"),y.register("BuckarooIdealQrPlugin",u,"[data-ideal-qr]"),y.register("BuckarooLoadScripts",class e extends s{loadSdk(){return new Promise(e=>{var t=document.createElement("script");t.src="https://checkout.buckaroo.nl/api/buckaroosdk/script/en-US",t.async=!0,document.head.appendChild(t),t.onload=()=>{e()}})}loadJquery(){return"undefined"==typeof jQuery||void 0===jQuery.ajax?new Promise(e=>{var t=document.createElement("script");t.src="https://code.jquery.com/jquery-3.2.1.min.js",t.async=!0,document.head.appendChild(t),t.onload=()=>{e()}}):Promise.resolve()}init(){this.loadJquery().then(()=>{document.$emitter.publish("buckaroo_scripts_jquery_loaded",{loaded:!0}),this.loadSdk().then(()=>{document.$emitter.publish("buckaroo_scripts_loaded",{loaded:!0})})})}}),y.register("BuckarooBanContact",class e extends s{init(){this._listenToSubmit(),this._createScript(()=>{for(let e of["bancontactmrcash_cardholdername","bancontactmrcash_cardnumber","bancontactmrcash_expirationmonth","bancontactmrcash_expirationyear"]){let t=document.getElementById(e);t&&t.addEventListener("change",this._handleInputChanged.bind(this))}this._getEncryptedData()})}_createScript(e){let t=document.createElement("script");t.type="text/javascript",t.src="https://static.buckaroo.nl/script/ClientSideEncryption001.js",t.addEventListener("load",e.bind(this),!1),document.head.appendChild(t)}_getEncryptedData(){let e=document.getElementById("bancontactmrcash_cardnumber"),t=document.getElementById("bancontactmrcash_expirationyear"),r=document.getElementById("bancontactmrcash_expirationmonth"),n=document.getElementById("bancontactmrcash_cardholdername");if(e&&t&&r&&n){var i,o,a,s;i=e.value,o=t.value,a=r.value,s=n.value,window.BuckarooClientSideEncryption.V001.encryptCardData(i,o,a,"",s,function(e){let t=document.getElementById("encryptedCardData");t&&(t.value=e)})}}_handleInputChanged(e){this._CheckValidate(),this._getEncryptedData()}_handleCheckField(e){switch(document.getElementById(e.id+"Error").style.display="none",e.id){case"bancontactmrcash_cardnumber":if(!window.BuckarooClientSideEncryption.V001.validateCardNumber(e.value.replace(/\s+/g,"")))return document.getElementById(e.id+"Error").style.display="block",!1;break;case"bancontactmrcash_cardholdername":if(!window.BuckarooClientSideEncryption.V001.validateCardholderName(e.value))return document.getElementById(e.id+"Error").style.display="block",!1;break;case"bancontactmrcash_expirationmonth":if(!window.BuckarooClientSideEncryption.V001.validateMonth(e.value))return document.getElementById(e.id+"Error").style.display="block",!1;break;case"bancontactmrcash_expirationyear":if(!window.BuckarooClientSideEncryption.V001.validateYear(e.value))return document.getElementById(e.id+"Error").style.display="block",!1}return!0}_CheckValidate(){let e=!1;for(let t of["bancontactmrcash_cardholdername","bancontactmrcash_cardnumber","bancontactmrcash_expirationmonth","bancontactmrcash_expirationyear"]){let r=document.getElementById(t);r&&!this._handleCheckField(r)&&(e=!0)}return this._disableConfirmFormSubmit(e)}_disableConfirmFormSubmit(e){return document.getElementById("confirmFormSubmit")&&(document.getElementById("confirmFormSubmit").disabled=e),e}_validateOnSubmit(e){e.preventDefault();let t=!this._CheckValidate();document.$emitter.publish("buckaroo_payment_validate",{valid:t,type:"bancontactmrcash"})}_listenToSubmit(){document.$emitter.subscribe("buckaroo_payment_submit",this._validateOnSubmit.bind(this))}}),y.register("BuckarooPayByBankSelect",p,"[data-bk-select]"),y.register("BuckarooPayByBankLogo",b,"[data-bk-paybybank-logo]"),y.register("IdealFastCheckoutPlugin",d,"[data-bk-ideal-fast-checkout]"))})();